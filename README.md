# ChessMaster Mobile

## Description
ChessMaster Mobile is a modern, mobile-first chess game application built with React, TypeScript, and Capacitor. Designed for Android devices, it offers multiple game modes including AI opponents, friend matches, online matchmaking, and interactive tutorials. The app features global leaderboards, detailed statistics, and a gamification system with levels, XP, and achievements—all optimized for mobile play.

## Technology Stack
- **Frontend:** React 18, TypeScript, Vite
- **Mobile Framework:** Capacitor
- **Android Platform:** Native Android integration via Capacitor
- **UI:** TailwindCSS, Shadcn UI (Radix UI primitives)
- **State Management:** TanStack Query (React Query)
- **Routing:** Wouter (SPA navigation)
- **Backend:** Express (optional, for API and multiplayer features)
- **Zoho Creator API:** Integrated via placeholder service for user, match, and rank operations
## Zoho API Integration

This project uses a Zoho Creator API service (`server/zoho-api-service.js`) for backend operations:

- User Registration/Login
- Updating User Profile Data (Elo Rating, Wins, Losses, Draws)
- Saving Match Record (to 'Match_History' form)

**Setup Instructions:**
1. Open `server/zoho-api-service.js`.
2. Paste your Zoho Client ID, Client Secret, and Redirect URI into the constants at the top of the file:
  - `ZOHO_CLIENT_ID`
  - `ZOHO_CLIENT_SECRET`
  - `ZOHO_REDIRECT_URI`
3. Replace the placeholder API functions with real Zoho Creator API calls as needed.

## How to Build and Run the Android App

### Prerequisites
- Node.js & npm
- Android Studio (for running and building the app)
- Java JDK (for Android builds)

### Steps
1. **Install dependencies:**
  ```bash
  cd ChessMaster
  npm install
  ```
2. **Build the web app:**
  ```bash
  npm run build
  ```
  This will output the production build to `client/dist`.
3. **Sync the build with Capacitor:**
  ```bash
  npx cap sync android
  ```
4. **Open the Android project in Android Studio:**
  ```bash
  npx cap open android
  ```
5. **Run the app:**
  - Use Android Studio to build and run the app on an emulator or physical device.
  - Alternatively, use `npx cap run android` for direct deployment.

## Features
- Play against AI or friends
- Global leaderboards
- Interactive chess tutorials
- Track your progress
- Multiple game modes
- Mobile-optimized UI and navigation

## Project Structure
- `client/` — React frontend source code
- `android/` — Native Android project (generated by Capacitor)
- `shared/` — Shared chess logic and schema
- `server/` — Optional Express backend for multiplayer/API

## License
MIT
- Component composition with Radix UI Slot pattern
- Path aliases for clean imports (@/, @shared/, @assets/)

### Backend Architecture

**Server Framework**
- Express.js with TypeScript for REST API
- ESM module system (type: "module")
- Middleware pipeline for logging, JSON parsing, and error handling

**API Structure**
- `/api/auth/*`: Authentication endpoints (Replit Auth integration)
- `/api/games/*`: Game CRUD operations and matchmaking
- `/api/leaderboard/*`: Global rankings and user rank
- `/api/tutorial/*`: Tutorial lessons and progress tracking
- Demo routes provided for UI showcase (auth temporarily disabled)

**Authentication Flow**
- Replit OpenID Connect (OIDC) integration via Passport.js
- Session management using PostgreSQL session store (connect-pg-simple)
- Cookie-based sessions with 7-day TTL
- User profile sync from Replit identity

**Data Layer**
- Repository pattern via `IStorage` interface in `server/storage.ts`
- `DatabaseStorage` implementation using Drizzle ORM
- Separation of concerns: routes → storage → database

### Database Architecture

**ORM & Schema**
- Drizzle ORM for type-safe database queries
- Schema definitions in `/shared/schema.ts` (shared between client/server)
- Drizzle-Zod for runtime validation from schema

**Tables**
1. **sessions**: Express session storage (sid, sess, expire)
2. **users**: User profiles with stats (id, email, name, level, xp, points, game stats, streaks)
3. **games**: Game records (id, players, mode, status, result, moves, timestamps)
4. **tutorialLessons**: Tutorial content (id, title, description, difficulty, content)
5. **userLessonProgress**: User tutorial tracking (userId, lessonId, completed, score)

**Key Design Decisions**
- PostgreSQL via Neon Serverless for edge-compatible deployment
- WebSocket constructor override for serverless compatibility
- Timestamps for all records (createdAt, updatedAt)
- Composite keys for progress tracking (userId + lessonId)

### Game Logic System

**Chess Engine** (`client/src/lib/chessEngine.ts`)
- Position management with FEN notation parsing
- Move validation (simplified implementation, extensible for full rules)
- Turn management and game state tracking

**Game Manager** (`client/src/lib/gameLogic.ts`)
- Game lifecycle management (create, join, move, complete)
- Multiple game mode support (AI, friend, online, bet)
- Time control integration (optional)
- Game state persistence

**Point System**
- Win/Draw: +4 points
- Lose/Resign: -2 points
- Level progression based on XP
- Streak tracking for consecutive wins

### Gamification & Progress

**Experience System**
- XP gained from games and tutorial completion
- Level-based progression with visual indicators
- Progress bars for XP and tutorial completion

**Statistics Tracking**
- Games played, wins, losses, draws, resignations
- Win rate calculation and display
- Current and best streak tracking
- Historical performance data

**Tutorial System**
- Progressive lesson structure with difficulty levels
- Interactive practice modes
- Score tracking per lesson
- Overall progress percentage

## External Dependencies

### Core Services

**Database**
- **Neon Serverless PostgreSQL**: Primary data store
- Connection via `@neondatabase/serverless` with WebSocket support
- Environment variable: `DATABASE_URL`

**Authentication**
- **Replit Auth (OpenID Connect)**: User authentication
- Required environment variables:
  - `REPLIT_DOMAINS`: Allowed domains for Replit deployment
  - `ISSUER_URL`: OIDC issuer (defaults to https://replit.com/oidc)
  - `REPL_ID`: Replit application identifier
  - `SESSION_SECRET`: Session encryption key

### Development Tools

**Replit Integration**
- `@replit/vite-plugin-runtime-error-modal`: Error overlay in development
- `@replit/vite-plugin-cartographer`: Development tooling
- Replit development banner for external access

**Build & Development**
- Vite plugins: React, runtime error overlay, cartographer
- TypeScript with strict mode and path aliases
- PostCSS with Tailwind and Autoprefixer
- Drizzle Kit for database migrations

### UI & Styling

**Component Libraries**
- Radix UI primitives (30+ components for accessibility)
- Lucide React for icons
- class-variance-authority for variant management
- cmdk for command palette functionality

**Utilities**
- clsx & tailwind-merge for class name management
- date-fns for date formatting
- nanoid for unique ID generation
- memoizee for function memoization

### State & Data Fetching

**React Query** (`@tanstack/react-query`)
- Server state synchronization
- Automatic cache invalidation
- Optimistic updates
- Configurable retry logic with custom 401 handling

### Form Management

**React Hook Form** with Zod validation
- `@hookform/resolvers` for schema validation
- Integration with Drizzle-Zod schemas
- Type-safe form state management

### Session Management

**Express Session Infrastructure**
- `express-session` for session middleware
- `connect-pg-simple` for PostgreSQL session store
- Secure cookie configuration (httpOnly, secure flags)

### Development Scripts

- `dev`: Development server with hot reload (tsx + Vite HMR)
- `build`: Production build (Vite frontend + esbuild backend)
- `start`: Production server
- `db:push`: Apply database schema changes via Drizzle
- `check`: TypeScript type checking

### Notable Architecture Decisions

1. **Shared Schema**: Database schema in `/shared` accessible to both client and server for type consistency
2. **Demo Mode**: Authentication temporarily disabled with demo user data for UI development/showcase
3. **Mobile-First**: Optimized for mobile with max-width containers and bottom navigation
4. **Serverless Ready**: Neon database with WebSocket polyfill for edge deployment
5. **Type Safety**: End-to-end TypeScript with Drizzle ORM and Zod validation
6. **Error Handling**: Centralized error middleware with status code normalization
7. **Asset Management**: Separate attached_assets directory for design resources
